kind: Environment
name: Express / React / PostgreSQL boilerplate, with Helm and Kubernetes manifests
type: primary
environmentVariables:
  GIT_USER: 'tbscode'
  HOST_NAME: 't1m.me'
  MODE: 'remote'
  GIT_PACKAGES_TOKEN: ''
  GIT_BRANCH: 'main'
  DJANGO_SECRET_KEY: "Some key very much secret haha :)"
components:
  - 
    kind: Helm
    name: image-manager
    runnerImage: 'ghcr.io/catthehacker/ubuntu:custom-20.04'
    gitBranch: main
    gitRepo: 'https://github.com/user-1024/tims-stack-anystack.git'
    deploy:
      - |
        echo "starting deployment"
      - |
        export TAG={{ env.unique }}
        export GIT_USER={{ env.vars.GIT_USER }}
        export BACKEND_IMG_URL=""
        export FRONTEND_IMG_URL=""
        make remote_trigger_git_action_wait_complete branch=main token={{ env.vars.GIT_PACKAGES_TOKEN }}
    destroy:
      - |
        helm uninstall github-auth-installation-{{ env.unique }}
    start:
      - |
        echo "noting todo on restart images are still build"
    stop:
      - |
        echo "noting todo on stop images are still build"
    exportVariables:
      - BACKEND_IMG_URL
      - FRONTEND_IMG_URL